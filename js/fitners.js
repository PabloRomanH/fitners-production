/*! fitners 2015-10-26 */
window.gyms=[{id:"-Jy8WJqcvr0D7a-ECxQE",area:"Eixample",name:"ÁCCURA Bruc"},{id:"-Jy8WJqeypZ0qDAtdisr",area:"Eixample",name:"ALTAFIT DIAGONAL"},{id:"-Jy8WJqfHTh9hs86MIQt",area:"Eixample",name:"BCN-FITNESS"},{id:"-Jy8WJqfHTh9hs86MIQu",area:"Eixample",name:"CEM SAGRADA FAMÍLIA"},{id:"-Jy8WJqgIS6Q0zYqOCEg",area:"Eixample",name:"CROSSFIT EIXAMPLE"},{id:"-Jy8WJqgIS6Q0zYqOCEh",area:"Eixample",name:"DIR Claris"},{id:"-Jy8WJqgIS6Q0zYqOCEi",area:"Eixample",name:"DIR Eixample"},{id:"-Jy8WJqhxN3kKueoB6bo",area:"Eixample",name:"DUET FIT BRUC"},{id:"-Jy8WJqhxN3kKueoB6bp",area:"Eixample",name:"DUET FIT GRAN VIA"},{id:"-Jy8WJqhxN3kKueoB6bq",area:"Eixample",name:"EIXAMPLE FITNESS"},{id:"-Jy8WJqidVgPb9IYOoki",area:"Eixample",name:"ESPORTIU ROCAFORT"},{id:"-Jy8WJqidVgPb9IYOokj",area:"Eixample",name:"EUROFITNESS AIGUAJOC"},{id:"-Jy8WJqidVgPb9IYOokk",area:"Eixample",name:"EUROFITNESS SANT MIQUEL"},{id:"-Jy8WJqjnoZ9-BVT-7jZ",area:"Eixample",name:"FISIC BARCELONA"},{id:"-Jy8WJqjnoZ9-BVT-7j_",area:"Eixample",name:"FITT BARCELONA"},{id:"-Jy8WJqkieHjUGsev9TU",area:"Eixample",name:"GIMNASIO CURVES Llançà"},{id:"-Jy8WJqkieHjUGsev9TV",area:"Eixample",name:"GIMNASIO CURVES Sagrada Familia"},{id:"-Jy8WJqkieHjUGsev9TW",area:"Eixample",name:"GIMNASIOS EIXAMPLE"},{id:"-Jy8WJql0AigdNrKhr_q",area:"Eixample",name:"GYROTONIC BARCELONA CENTER"},{id:"-Jy8WJql0AigdNrKhr_r",area:"Eixample",name:"HOLMES PLACE Balmes"},{id:"-Jy8WJqmQamsEFV9XiLq",area:"Eixample",name:"HOLMES PLACE Urquinaona"},{id:"-Jy8WJqnGCegRUZa37x5",area:"Eixample",name:"LIFESTYLE CONCEPT Barcelona"},{id:"-Jy8WJqod8oVXR1bF2O3",area:"Eixample",name:"MAYAN LUXURY SPA"},{id:"-Jy8WJqod8oVXR1bF2O4",area:"Eixample",name:"METROPOLITAN Las Arenas"},{id:"-Jy8WJqod8oVXR1bF2O5",area:"Eixample",name:"METROPOLITAN Sagrada Familia"},{id:"-Jy8WJqpg_PMgIp91B68",area:"Eixample",name:"NEW BODY BCN"},{id:"-Jy8WJqpg_PMgIp91B69",area:"Eixample",name:"REBODY"},{id:"-Jy8WJqqxOQEszhQRXqj",area:"Eixample",name:"REEBOOK CROSSFIT BCN"},{id:"-Jy8WJqqxOQEszhQRXqk",area:"Eixample",name:"SALUD Y FORMA"},{id:"-Jy8WJqrEmJ-r0g9NT-9",area:"Eixample",name:"Seven DIR"},{id:"-Jy8WJqrEmJ-r0g9NT-A",area:"Eixample",name:"VITA LIBERTE Plaza Espanya"},{id:"-Jy8WJqs1cD0MLQ8Z4Er",area:"Eixample",name:"WELLNESS 33"},{id:"-Jy8WJqs1cD0MLQ8Z4Es",area:"Eixample",name:"YOGABODY FITNESS"},{id:"-Jy8WJqtSGFyPLpWr-nn",area:"Ciutat Vella",name:"CEM CAN RICART"},{id:"-Jy8WJqu6-pFIswEhni9",area:"Ciutat Vella",name:"CEM FRONTÓ COLOM"},{id:"-Jy8WJqu6-pFIswEhniA",area:"Ciutat Vella",name:"CEM MARÍTIM"},{id:"-Jy8WJqvtAw5fAv0_S8F",area:"Ciutat Vella",name:"CLUB NATACIÓ ATLÈTIC BARCELONETA"},{id:"-Jy8WJqvtAw5fAv0_S8G",area:"Ciutat Vella",name:"CLUB NATACIÓ BARCELONA"},{id:"-Jy8WJqwOH-7plXno4u8",area:"Ciutat Vella",name:"SANT PAU SPORT CLUB"},{id:"-Jy8WJqwOH-7plXno4u9",area:"Ciutat Vella",name:"SWEAT GYM BLISS SPA "},{id:"-Jy8WJqwOH-7plXno4uA",area:"Ciutat Vella",name:"UFEC ESTACIO DEL NORD"},{id:"-Jy8WJqxC32eHjacRtKs",area:"Gracia",name:"CEM CLAROR"},{id:"-Jy8WJqxC32eHjacRtKt",area:"Gracia",name:"DIR Gràcia"},{id:"-Jy8WJqyTaea2IejKuoQ",area:"Gracia",name:"DON GIMNAS"},{id:"-Jy8WJqyTaea2IejKuoR",area:"Gracia",name:"ESPORTIU CLARET"},{id:"-Jy8WJqzPwyOYw_JfaIW",area:"Gracia",name:"EUROFITNESS PERILL"},{id:"-Jy8WJqzPwyOYw_JfaIX",area:"Gracia",name:"GIMNASIO ARSENAL"},{id:"-Jy8WJqzPwyOYw_JfaIY",area:"Gracia",name:"HOLMES PLACE EUROPOLIS Sardenya"},{id:"-Jy8WJr-6yG_AHG4dGLX",area:"Gracia",name:"MB COACHING SPORT"},{id:"-Jy8WJr-6yG_AHG4dGLY",area:"Gracia",name:"METROPOLITAN Balmes"},{id:"-Jy8WJr-6yG_AHG4dGLZ",area:"Sant Marti",name:"ANYTIME FITNESS CIUTADELLA"},{id:"-Jy8WJr0KcFhHRfDCv22",area:"Sant Marti",name:"ANYTIME FITNESS POBLENOU"},{id:"-Jy8WJr0KcFhHRfDCv23",area:"Sant Marti",name:"CEM BAC DE RODA"},{id:"-Jy8WJr0KcFhHRfDCv24",area:"Sant Marti",name:"CEM CAN FELIPA"},{id:"-Jy8WJr1bhdAX7DgKIh-",area:"Sant Marti",name:"CEM JÚPITER"},{id:"-Jy8WJr1bhdAX7DgKIh0",area:"Sant Marti",name:"CEM MARESME"},{id:"-Jy8WJr28hK2YkhvPoQ_",area:"Sant Marti",name:"CEM VERNEDA"},{id:"-Jy8WJr3acFfgGLwwU0c",area:"Sant Marti",name:"CEM VINTRÓ"},{id:"-Jy8WJr3acFfgGLwwU0d",area:"Sant Marti",name:"CROSSFIT GALA"},{id:"-Jy8WJr4QS0zBiGsx_IV",area:"Sant Marti",name:"CROSSFIT POBLENOU"},{id:"-Jy8WJr4QS0zBiGsx_IW",area:"Sant Marti",name:"FITNESS CLUB BARCELONA"},{id:"-Jy8WJr5S63z3kAvahUj",area:"Sant Marti",name:"MERCURY SPORT CLUB"},{id:"-Jy8WJr5S63z3kAvahUk",area:"Sant Marti",name:"NOVA ICÀRIA Esports Club"},{id:"-Jy8WJr6RobMF-cOnqLZ",area:"Sant Marti",name:"PALEO BARCELONA"},{id:"-Jy8WJr7pldc7KSO9q2g",area:"Sant Marti",name:"SANOAKTIV"},{id:"-Jy8WJr8CyQHo2jp2w3_",area:"Sant Marti",name:"SIMPLY GYM"},{id:"-Jy8WJr8CyQHo2jp2w3a",area:"Sarria-Sant Gervasi",name:"ANYTIME FITNESS Barcelona"},{id:"-Jy8WJr9XwWoFm5m7J6h",area:"Sarria-Sant Gervasi",name:"ANYTIME FITNESS SARRIA"},{id:"-Jy8WJr9XwWoFm5m7J6i",area:"Sarria-Sant Gervasi",name:"ARENA SPORT"},{id:"-Jy8WJr9XwWoFm5m7J6j",area:"Sarria-Sant Gervasi",name:"ARSENAL Femenino"},{id:"-Jy8WJrAKTIiE93x0Bqf",area:"Sarria-Sant Gervasi",name:"ARSENAL Masculino"},{id:"-Jy8WJrBAI-lxI0v5i-Z",area:"Sarria-Sant Gervasi",name:"BE YOU WOMAN"},{id:"-Jy8WJrBAI-lxI0v5i-_",area:"Sarria-Sant Gervasi",name:"BONASPORT"},{id:"-Jy8WJrC7qF3f-23L24x",area:"Sarria-Sant Gervasi",name:"CEM CAN CARALLEU"},{id:"-Jy8WJrDdR56yw56cQpP",area:"Sarria-Sant Gervasi",name:"CENTRE FITNESS SARRIA"},{id:"-Jy8WJrDdR56yw56cQpQ",area:"Sarria-Sant Gervasi",name:"CENTRO PILAR DOMINGUEZ"},{id:"-Jy8WJrEY314xP8dSoIN",area:"Sarria-Sant Gervasi",name:"CLINICA DEPORTIVA IANES"},{id:"-Jy8WJrEY314xP8dSoIO",area:"Sarria-Sant Gervasi",name:"DINAMIC"},{id:"-Jy8WJrFr-92rZYHqd10",area:"Sarria-Sant Gervasi",name:"DIR Diagonal"},{id:"-Jy8WJrFr-92rZYHqd11",area:"Sarria-Sant Gervasi",name:"DIR Tres Torres"},{id:"-Jy8WJrGhBVBAm6rwEAV",area:"Sarria-Sant Gervasi",name:"DIR Tuset"},{id:"-Jy8WJrHkDgjdlZeLyos",area:"Sarria-Sant Gervasi",name:"DIR UP and DOWN"},{id:"-Jy8WJrHkDgjdlZeLyot",area:"Sarria-Sant Gervasi",name:"DOJO SANT GERVASI"},{id:"-Jy8WJrIbsnQ2zkdRyoD",area:"Sarria-Sant Gervasi",name:"DUET FIT VIA AUGUSTA"},{id:"-Jy8WJrJ6CD7XApK80I3",area:"Sarria-Sant Gervasi",name:"FAST FITNESS"},{id:"-Jy8WJrJ6CD7XApK80I4",area:"Sarria-Sant Gervasi",name:"FESS LA SALLE"},{id:"-Jy8WJrKFs2uEsABdCqs",area:"Sarria-Sant Gervasi",name:"FIFTYFIVE TRAINING CENTER"},{id:"-Jy8WJrKFs2uEsABdCqt",area:"Sarria-Sant Gervasi",name:"FITNESS LLEURE"},{id:"-Jy8WJrKFs2uEsABdCqu",area:"Sarria-Sant Gervasi",name:"GIMNÀS SARRIÀ"},{id:"-Jy8WJrLFJvwChUguH9G",area:"Sarria-Sant Gervasi",name:"GIMNASIO FEMENINO LINEA"},{id:"-Jy8WJrLFJvwChUguH9H",area:"Sarria-Sant Gervasi",name:"IN 20 MINUTES"},{id:"-Jy8WJrM5Gg0hoj8wIEg",area:"Sarria-Sant Gervasi",name:"INVICTUS WORKOUT"},{id:"-Jy8WJrM5Gg0hoj8wIEh",area:"Sarria-Sant Gervasi",name:"IQ FITNESS"},{id:"-Jy8WJrNOiUCvtZg0H8M",area:"Sarria-Sant Gervasi",name:"IRADIER CLUB MUJER"},{id:"-Jy8WJrNOiUCvtZg0H8N",area:"Sarria-Sant Gervasi",name:"KIESER TRAINING Barcelona"},{id:"-Jy8WJrO2huoX53mcp3z",area:"Sarria-Sant Gervasi",name:"KNOCK DOWN Barcelona"},{id:"-Jy8WJrO2huoX53mcp4-",area:"Sarria-Sant Gervasi",name:"LA SALA MAGALI"},{id:"-Jy8WJrPGyc3t9dutD6_",area:"Sarria-Sant Gervasi",name:"METROPOLITAN IRADIER"},{id:"-Jy8WJrQCcb-0589naiH",area:"Sarria-Sant Gervasi",name:"NUUM"},{id:"-Jy8WJrQCcb-0589naiI",area:"Sarria-Sant Gervasi",name:"NYTTA"},{id:"-Jy8WJrR9f1ieE7TWh4q",area:"Sarria-Sant Gervasi",name:"O2 CENTRO WELLNESS"},{id:"-Jy8WJrR9f1ieE7TWh4r",area:"Sarria-Sant Gervasi",name:"PISCINES SANTALO"},{id:"-Jy8WJrSXDY2g4AUtCP7",area:"Sarria-Sant Gervasi",name:"POLIESPORTIU LA SALLE"},{id:"-Jy8WJrSXDY2g4AUtCP8",area:"Sarria-Sant Gervasi",name:"PROTRAINING CENTER"},{id:"-Jy8WJrTfIHGBKcDAA2x",area:"Sarria-Sant Gervasi",name:"PUTXET SPORT"},{id:"-Jy8WJrTfIHGBKcDAA2y",area:"Sarria-Sant Gervasi",name:"R.C.TENIS BARCELONA 1899"},{id:"-Jy8WJrURW-_vVT-JfCf",area:"Sarria-Sant Gervasi",name:"SIAUNCUERPOSANO"},{id:"-Jy8WJrVYDkmJI7TIIbs",area:"Sarria-Sant Gervasi",name:"SPORT FEMENI BALMES"},{id:"-Jy8WJrWCvgapzvHg-fV",area:"Sarria-Sant Gervasi",name:"WATERBIKE BARCELONA"},{id:"-Jy8WJrWCvgapzvHg-fW",area:"Sarria-Sant Gervasi",name:"WELL CENTRO"},{id:"-Jy8WJrXiiFKRn5QZd5w",area:"Sarria-Sant Gervasi",name:"You´re 10"},{id:"-Jy8WJrXiiFKRn5QZd5x",area:"Les Corts",name:"C.E.LAIETA"},{id:"-Jy8WJrY4qRQeDdMFJWk",area:"Les Corts",name:"CITY SPORT"},{id:"-Jy8WJrY4qRQeDdMFJWl",area:"Les Corts",name:"CROSSFIT DIAGONAL"},{id:"-Jy8WJrZBXRJrel_gxKa",area:"Les Corts",name:"DIR Av.Madrid"},{id:"-Jy8WJrZBXRJrel_gxKb",area:"Les Corts",name:"DIR Campus"},{id:"-Jy8WJr_o_SiEu0IO5D_",area:"Les Corts",name:"ESPORTIU BADRENA"},{id:"-Jy8WJr_o_SiEu0IO5Da",area:"Les Corts",name:"GIMNAS UPC"},{id:"-Jy8WJramcefLNeHTBkz",area:"Les Corts",name:"GIMNASIO CURVES Barcelona"},{id:"-Jy8WJramcefLNeHTBl-",area:"Les Corts",name:"GYM LAIETA"},{id:"-Jy8WJrbEVepuarOBNtG",area:"Les Corts",name:"HOLMES PLACE EUROPOLIS Les Corts"},{id:"-Jy8WJrbEVepuarOBNtH",area:"Les Corts",name:"McFIT Les Corts"},{id:"-Jy8WJrbEVepuarOBNtI",area:"Les Corts",name:"METROPOLITAN Galileo"},{id:"-Jy8WJrctwDJRDkehbA_",area:"Sants-Montjuic",name:"ATLES ESPORTS LA BORDETA"},{id:"-Jy8WJrd2sCNsXciLZUf",area:"Sants-Montjuic",name:"CEM ESPANYA INDUSTRIAL"},{id:"-Jy8WJrd2sCNsXciLZUg",area:"Sants-Montjuic",name:"CLUB ESPORTIU MEDITERRANI"},{id:"-Jy8WJreFDM9O32MAncQ",area:"Sants-Montjuic",name:"CLUB NATACIÓ MONTJUÏC"},{id:"-Jy8WJrf3nIZzGY0uDnl",area:"Sants-Montjuic",name:"DIR Tarragona"},{id:"-Jy8WJrgR866cUBaKbn7",area:"Sants-Montjuic",name:"FITNESS PLACE"},{id:"-Jy8WJrgR866cUBaKbn8",area:"Sants-Montjuic",name:"FITNESS SANTS"},{id:"-Jy8WJrhqaN2E-bD56ZO",area:"Sants-Montjuic",name:"GYM BARCELONA SANTS"},{id:"-Jy8WJrjfXLl1k6MxxJ4",area:"Sants-Montjuic",name:"GYM FIRA"},{id:"-Jy8WJrjfXLl1k6MxxJ5",area:"Sants-Montjuic",name:"GYM WORLD TRADE CENTER"},{id:"-Jy8WJrkpEDyfTwL8heo",area:"Sants-Montjuic",name:"PISCINAS PICORNELL"},{id:"-Jy8WJrkpEDyfTwL8hep",area:"Sants-Montjuic",name:"TENIS POMPEIA"},{id:"-Jy8WJrkpEDyfTwL8heq",area:"Sants-Montjuic",name:"WELLNESS POINT"},{id:"-Jy8WJrl2o4r3ItKdCfG",area:"Horta-Guinardó",name:"ACCENTENNIS BARCELONA"},{id:"-Jy8WJrl2o4r3ItKdCfH",area:"Horta-Guinardó",name:"CEM MUNDET"},{id:"-Jy8WJrmE3JMbaOwf6EG",area:"Horta-Guinardó",name:"CLUB ESPORTIU HISPANO FRANCES"},{id:"-Jy8WJrorvIh51rrI5AP",area:"Horta-Guinardó",name:"CONDAL CROSSFIT"},{id:"-Jy8WJrorvIh51rrI5AQ",area:"Horta-Guinardó",name:"DIR Castillejos"},{id:"-Jy8WJrp-ybh7Y8gGEqN",area:"Horta-Guinardó",name:"DIR Claret"},{id:"-Jy8WJrp-ybh7Y8gGEqO",area:"Horta-Guinardó",name:"DIR Club Hispà"},{id:"-Jy8WJrq-SHRyipcQilU",area:"Horta-Guinardó",name:"EUROFITNESS HORTA"},{id:"-Jy8WJrq-SHRyipcQilV",area:"Horta-Guinardó",name:"HORTA ESPORTIVA"},{id:"-Jy8WJrrGkYIyDcIV7Tq",area:"Horta-Guinardó",name:"NICK SPA"},{id:"-Jy8WJrrGkYIyDcIV7Tr",area:"Horta-Guinardó",name:"VALL PARC"},{id:"-Jy8WJrsu_14M4_xVt_m",area:"Horta-Guinardó",name:"WHU SHU OLIMPO"},{id:"-Jy8WJrsu_14M4_xVt_n",area:"Sant Andreu",name:"CEM BON PASTOR"},{id:"-Jy8WJrtcw1kaHfHOSOP",area:"Sant Andreu",name:"DIR Maragall"},{id:"-Jy8WJrub7uf3QNBtAKg",area:"Sant Andreu",name:"FITNESS FACTORY CLUB "},{id:"-Jy8WJrvM2x8VTgY9CiH",area:"Sant Andreu",name:"GIMNASIO 30 MINUTOS Sant Andreu"},{id:"-Jy8WJrvM2x8VTgY9CiI",area:"Sant Andreu",name:"McFIT BARCELONA CLOT"},{id:"-Jy8WJrwaa_p4k4-AxB-",area:"Sant Andreu",name:"VIVA GYM Meridiana"},{id:"-Jy8WJrwaa_p4k4-AxB0",area:"Sant Andreu",name:"YAWARA GIMNASIO"},{id:"-Jy8WJrxQlUeXgvbHA5w",area:"Nou Barris",name:"CEM Cotxeres Borbó"},{id:"-Jy8WJry7GYeEPOk_PmO",area:"Nou Barris",name:"CEM TRINITAT VELLA"},{id:"-Jy8WJry7GYeEPOk_PmP",area:"Nou Barris",name:"EUROFITNESS ARTESANIA"},{id:"-Jy8WJrzee3XXbF7vl_n",area:"Nou Barris",name:"EUROFITNESS CAN CUYÀS"},{id:"-Jy8WJrzee3XXbF7vl_o",area:"Nou Barris",name:"EUROFITNESS CAN DRAGÓ"},{id:"-Jy8WJs-2Z_tY44-pcka",area:"Nou Barris",name:"GIMNÀS ESPORTS FABRA"},{id:"-Jy8WJs-2Z_tY44-pckb",area:"Nou Barris",name:"VIRGIN ACTIVE Can Dragó"}],Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){null===b?b=0:0>b&&(b=Math.max(0,this.length+b));for(var c=b,d=this.length;d>c;c++)if(this[c]===a)return c;return-1}),function(){function a(a){for(var b=0;b<window.gyms.length;b++)if(window.gyms[b].id==a)return window.gyms[b];return null}var b=angular.module("fitners",["ui.bootstrap","sticky","rzModule","angularFileUpload"]);b.config(function(a){a.html5Mode(!0)}),b.factory("database",function(){return"http://fitners-dev.firebaseio.com/"}),b.controller("SearchController",function(a,b,c,d){function e(a){return a=a.replace(/Á/g,"A"),a=a.replace(/É/g,"E"),a=a.replace(/Í/g,"I"),a=a.replace(/Ó/g,"O"),a=a.replace(/Ú/g,"U"),a=a.replace(/À/g,"A"),a=a.replace(/È/g,"E"),a=a.replace(/Ò/g,"O"),a=a.replace(/Ü/g,"U"),a=a.replace(/Ï/g,"I")}function f(){var a="";return k.goalVolume&&(a+="Volume "),k.goalDefinition&&(a+="Definition "),k.goalWeight&&(a+="Weight "),k.goalCond&&(a+="Condition "),k.goalDiet&&(a+="Diet"),a}function g(){var a="";return k.training0&&(a+="licenciado "),k.training1&&(a+="TAFAD "),k.training2&&(a+="500horas"),a}function h(a){var b=0,c=0,d=0,e=0,f=0,g=0,h=0;for(var i in a.ratings)h++,b+=a.ratings[i].compatibility,c+=a.ratings[i].knowledge,d+=a.ratings[i].pricequality,e+=a.ratings[i].punctuality,f+=a.ratings[i].results,g+=a.ratings[i].stars;return 0===h&&(h=1),{compatibility:b/h,knowledge:c/h,pricequality:d/h,punctuality:e/h,results:f/h,total:g/h}}function i(a){var b=0;for(var c in a.ratings)b++;var d=5;return(1-Math.exp(-b/d))*a.score.total}function j(a,b){return b.rank-a.rank}var k=this;k.results=[],k.searching=!1,k.gym="",k.area="",k.goalVolume=!1,k.goalDefinition=!1,k.goalWeight=!1,k.goalDiet=!1,k.goalCond=!1,k.gyms=window.gyms,k.areas=["Eixample","Ciutat Vella","Gràcia","Sant Martí","Sarrià-Sant Gervasi","Les Corts","Sants-Montjuïc","Horta-Guinardó","Sant Andreu","Nou Barris"],k.searchcriteria="gym",k.showGoal=!1,k.showPrice=!1,k.pricerange=[20,60],k.showTraining=!1,k.training0=!1,k.training1=!1,k.training2=!1,k.showYears=!1,k.years=5;var l,m=a.path();"/barcelona"==m?l="Barcelona":"/madrid"==m?l="Madrid":(l="Barcelona",a.path("/barcelona"));b.numFullStars=function(a){return Math.round(a),a/=2,new Array(Math.floor(a))},b.isHalfStar=function(a){return a%2},b.numEmptyStars=function(a){Math.round(a);var c=a/2;return c=5-Math.floor(c)-(b.isHalfStar(a)?1:0),new Array(c)},b.keys=Object.keys,k.comparator=function(a,b){if("string"!=typeof a)return!1;var c=-1!=e(a.toUpperCase()).search(e(b.toUpperCase()));return c};var n,o=new Firebase(d+"coaches/");k.searching=!0,o.orderByChild("city").startAt(l).endAt(l).on("value",function(a){n=a,k.filter(),b.$$phase||b.$apply()}),k.filter=function(){return k.results=[],null===n.val()?(k.searching=!1,void b.$apply()):("gym"==k.searchcriteria&&k.gym.length>0?ga("send","event","search","gymsearch"):"area"==k.searchcriteria&&k.area.length>0?ga("send","event","search","areasearch"):ga("send","event","search","allsearch"),k.showGoal&&ga("send","event","filter","by goal",f()),k.showPrice&&ga("send","event","filter","by price",""+k.pricerange[0]+"-"+k.pricerange[1]),k.showTraining&&ga("send","event","filter","by training",g()),n.forEach(function(a){var b=a.val();if(b.id=a.key(),b.published){if("gym"==k.searchcriteria&&k.gym.length>0){for(var c,d=0;d<k.gyms.length;d++)if(k.gyms[d].name==k.gym){c=k.gyms[d].id;break}if(!b.gym||b.gym!=c&&-1==b.gym.indexOf(c))return}else if("area"==k.searchcriteria&&k.area.length>0&&b.area!=k.area&&-1==b.area.indexOf(k.area))return;if(k.showGoal){if(k.goalVolume&&-1==b.goals.indexOf(1))return;if(k.goalDefinition&&-1==b.goals.indexOf(2))return;if(k.goalWeight&&-1==b.goals.indexOf(3))return;if(k.goalCond&&-1==b.goals.indexOf(4))return;if(k.goalDiet&&-1==b.goals.indexOf(5))return}if(!k.showPrice||!(b.wage<k.pricerange[0]||b.wage>k.pricerange[1])){if(k.showTraining&&(k.training0||k.training1||k.training2)){var e=!1;if(k.training0&&0===b.training&&(e=!0),k.training1&&1==b.training&&(e=!0),k.training2&&2==b.training&&(e=!0),!e)return}k.showYears&&b.experience<k.years||(b.score=h(b),b.rank=i(b),k.results.push(b))}}}),k.results.sort(j),void(k.searching=!1))},k.showComments=function(a){ga("send","event","navigation","show comments",a.name,k.results.indexOf(a));c.open({animation:!0,templateUrl:"comments.html",controller:"CommentsModalController",controllerAs:"commentsCtrl",resolve:{coach:function(){return a}}})},k.showPhone=function(a){ga("send","event","contact","show phone",a.name);c.open({animation:!0,templateUrl:"phone.html",controller:"PhoneModalController",controllerAs:"phoneCtrl",resolve:{telephone:function(){return a.telephone}}})},k.showPhoto=function(a){ga("send","event","navigation","show photo",a.name,k.results.indexOf(a));c.open({animation:!0,templateUrl:"photo.html",controller:"PhotoModalController",controllerAs:"photoCtrl",windowClass:"photomodal",resolve:{url:function(){return a.photo}}})},k.showTerms=function(a){c.open({animation:!0,templateUrl:"terms.html"})},k.emailCoach=function(a){ga("send","event","contact","email",a.name)},k.callCoach=function(a){ga("send","event","contact","phone",a.name)}}),b.controller("CommentsModalController",function(a,b,c,d,e){function f(a){b.close();c.open({animation:!0,templateUrl:"writecomment.html",controller:"WriteModalController",controllerAs:"writeCtrl",resolve:{coach:function(){return d},loginData:function(){return a}}})}var g=this;g.coach=d,g.ratings=["knowledge","compatibility","results","punctuality","pricequality"],d.ratings&&(g.ratingsArray=Object.keys(d.ratings).map(function(a){return d.ratings[a]}));var h,i=new Firebase(e),j=i.getAuth();if(j&&(g.loggedin=j.facebook.displayName,h=j.uid),h)for(var k in d.ratings)if(k==h){g.existing=!0;break}a.keys=Object.keys,g.showWrite=function(){ga("send","event","navigation","addcomment",d.name),j?f(j):i.authWithOAuthPopup("facebook",function(a,b){a?console.log("Login Failed!",a):(console.log("Authenticated successfully with payload:",b),f(b))})},g.close=function(){b.close()},g.logout=function(){i.unauth(),g.loggedin=null,g.existing=!1,j=null},a.numFullStars=function(a){return Math.round(a),a/=2,new Array(Math.floor(a))},a.isHalfStar=function(a){return a%2},a.numEmptyStars=function(b){Math.round(b);var c=b/2;return c=5-Math.floor(c)-(a.isHalfStar(b)?1:0),new Array(c)}}),b.controller("WriteModalController",function(a,b,c,d,e,f){function g(){i.showGoalAlert=!1,i.showWeightAlert=!1,i.showDefinitionAlert=!1,i.showVolumeAlert=!1,i.showMonthsAlert=!1,i.showCommentAlert=!1,i.showScoreAlert=!1,i.showFailedAlert=!1,i.showPhotoAlert=!1}function h(a){if(i.comment=a.comment,i.stars=""+a.stars,i.months=a.months,i.goal=a.goal,i.compatibility=a.compatibility,i.knowledge=a.knowledge,i.pricequality=a.pricequality,i.punctuality=a.punctuality,i.results=a.results,i.before=a.before,i.after=a.after,a.photos)for(var b=0;b<a.photos.length;b++)i.uploadingFiles[""+b]={status:"success",url:a.photos[b]}}var i=this;i.coach=d,i.goals=[{text:"Volumen",value:1},{text:"Definición",value:2},{text:"Adelgazar",value:3},{text:"Forma física",value:4},{text:"Otro",value:0}],i.grades=[{text:"0",value:0},{text:"1",value:1},{text:"2",value:2},{text:"3",value:3},{text:"4",value:4},{text:"5",value:5},{text:"6",value:6},{text:"7",value:7},{text:"8",value:8},{text:"9",value:9},{text:"10",value:10}],i.goal=void 0,i.months=void 0,i.comment="",i.uploadingFiles={};for(var j in d.ratings)if(j==e.uid){h(d.ratings[j]);break}i.sendingReview=!1,g(),i.uploader=new c({url:"https://imgur-apiv3.p.mashape.com/3/image",alias:"image",headers:{"X-Mashape-Key":"e29I5NOsyxmshLC129HpZMwJIFMkp15pd9EjsncJ8ibWHPlLYN",Authorization:"Client-ID 6f0f91c246fba32"},autoUpload:!0}),i.uploader.filters.push({name:"imageFilter",fn:function(a,b){var c="|"+a.type.slice(a.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(c)}}),i.uploader.onAfterAddingFile=function(a){i.uploadingFiles[a.file.name]={status:"uploading",completed:0,item:a}},i.uploader.onProgressItem=function(a,b){100==b?i.uploadingFiles[a.file.name]={status:"processing",item:a}:i.uploadingFiles[a.file.name]={status:"uploading",completed:b,item:a}},i.uploader.onSuccessItem=function(a,b,c,d){if(b.error){var e;"file too large"==b.error&&(e="Fichero demasiado grande"),i.uploader.removeFromQueue(i.uploadingFiles[a.file.name].item),i.uploadingFiles[a.file.name]={status:"error",item:a,error:e}}else i.uploadingFiles[a.file.name]={status:"success",url:b.data.link,item:a}},i.uploader.onErrorItem=function(a,b,c,d){console.log("error",a,b,c,d),i.uploader.removeFromQueue(i.uploadingFiles[a.file.name].item),i.uploadingFiles[a.file.name]={status:"error",item:a}},i.cancelFile=function(a){i.uploadingFiles[a].item&&("uploading"==i.uploadingFiles[a].status&&i.uploader.cancelItem(i.uploadingFiles[a].item),"error"!=i.uploadingFiles[a].status&&i.uploader.removeFromQueue(i.uploadingFiles[a].item)),delete i.uploadingFiles[a]},i.close=function(){a.close()},i.submitComment=function(){g();var c=!1;void 0===i.goal&&(i.showGoalAlert=!0,c=!0),2==i.goal&&(i.before&&(i.before<10||i.before>50)&&(i.showDefinitionAlert=!0,c=!0),i.after&&(i.after<10||i.after>50)&&(i.showDefinitionAlert=!0,c=!0)),i.months||(i.showMonthsAlert=!0,c=!0),i.comment.length<100&&(i.showCommentAlert=!0,c=!0),void 0===i.goal&&(i.showGoalAlert=!0,c=!0),(void 0===i.knowledge||void 0===i.compatibility||void 0===i.results||void 0===i.punctuality||void 0===i.pricequality||void 0===i.stars)&&(i.showScoreAlert=!0,c=!0);var h=[];for(var j in i.uploadingFiles)"success"==i.uploadingFiles[j].status?h.push(i.uploadingFiles[j].url):"error"!=i.uploadingFiles[j].status&&(i.showPhotoAlert=!0,c=!0);if(!c){ga("send","event","navigation","submit comment",d.name);var k={comment:i.comment,name:e.facebook.displayName,photo:e.facebook.profileImageURL,stars:parseInt(i.stars),months:i.months,goal:i.goal,compatibility:i.compatibility,knowledge:i.knowledge,pricequality:i.pricequality,punctuality:i.punctuality,results:i.results,photos:h,timestamp:Firebase.ServerValue.TIMESTAMP};0!==i.goal&&(i.before&&(k.before=i.before),i.after&&(k.after=i.after)),i.sendingReview=!0;var l=new Firebase(f+"coaches");l.child(d.id+"/ratings/"+e.uid).set(k,function(c){if(c)i.showFailedAlert=!0,i.sendingReview=!1;else{b.open({animation:!0,templateUrl:"done.html",controller:"DoneModalController",controllerAs:"doneCtrl",size:"sm"});a.close()}})}}}),b.controller("PhotoModalController",function(a,b){var c=this;c.url=b,c.close=function(){a.close()}}),b.controller("DoneModalController",function(a){var b=this;b.close=function(){a.close()}}),b.controller("PhoneModalController",function(a,b){var c=this;c.telephone=b,c.close=function(){a.close()}}),b.directive("radioButtonGroup",function(){return{restrict:"E",scope:{model:"=",options:"=",id:"=",name:"=",suffix:"="},controller:function(a){a.activate=function(b,c){a.model=b[a.id],c.stopPropagation&&c.stopPropagation(),c.preventDefault&&c.preventDefault(),c.cancelBubble=!0,c.returnValue=!1},a.isActive=function(b){return b[a.id]==a.model},a.getName=function(b){return b[a.name]}},template:"<button type='button' class='btn btn-{{suffix}}' ng-class='{active: isActive(option)}'ng-repeat='option in options' ng-click='activate(option, $event)'>{{getName(option)}} </button>"}}),b.filter("goals",[function(){return function(a){var b="";for(i=0;i<a.length;i++)i>0&&(b+=", "),1==a[i]&&(b+="Volumen"),2==a[i]&&(b+="Tonificación"),3==a[i]&&(b+="Perder peso"),4==a[i]&&(b+="Forma física"),5==a[i]&&(b+="Nutrición");return b}}]),b.filter("training",[function(){return function(a){var b=["Licenciado en Ciencias de la Actividad Física y el Deporte","TAFAD (Técnico superior en Animación y Actividades Físicas y Deportivas)","> 500 horas de formación específica"];return b[a]}}]),b.filter("pricerange",[function(){return function(a){var b="";return b=""+a[0]+"-"+a[1]+"€"}}]),b.filter("areas",[function(){return function(a){var b="";for(i=0;i<a.length;i++)b.length>0&&(b+=", "),b+=a[i];return b}}]),b.filter("gyms",[function(){return function(b){var c="";for(i=0;i<b.length;i++)c.length>0&&(c+=", "),c+=a(b[i]).name;return c}}]),b.filter("coachname",[function(){return function(a){var b=a.replace(" ","\n");return b}}])}();